\section{نتایج عملی}\label{sec:experiments}

در این پروژه ما ابزار
\lr{EStResT}
را پیاده‌سازی کرده و بهبود داده‌ایم.
به کمک این ابزار، می‌توانیم یک ساختمان رویداد تعریف کنیم،
آن را به یک مدل دودویی ترجمه کنیم
و مساله علت واقعی را روی مدل ترجمه شده بررسی کنیم.
تعریف مدل علّی دودویی و بررسی مساله علت واقعی 
روی این مدل نیز به تنهایی در این ابزار ممکن است.
با توجه به پیچیدگی پیدا کردن
$W$ و $w$
در حالت غیربهینه، حل مساله علیت در این ابزار
نیازمند ارائه این دو آرگومان نیز می‌باشد.

بهبودهای عملکرد این ابزار به طور کلی
در دو دسته قرار می‌گیرند:

\begin{enumerate}
  \item
    بهبود چندجمله‌ای عملکردهای موجود
    در نسخه اولیه ابزار
  \item
    بهبود روش حل مساله علیت
    به کمک تئوری‌های ارائه شده در بخش
    \ref{sec:improvements}
\end{enumerate}

در ادامه به بررسی هر کدام از این بخش‌ها می‌پردازیم.

\subsection{بهبود چندجمله‌ای عملکردهای موجود}

در ترخیص
\LTRfootnote{Release}
اولیه این ابزار،
هدف اصلی درستی عملکرد بوده و به همین دلیل،
دو عملکرد محاسبه مقدار متغیرها در مدل علّی
(متد \lr{\texttt{evaluate}})
و ثابت نگه داشتن مجموعه‌ای از متغیرها
(متد \lr{\texttt{intervene}})
با روش ساده‌تری اما پرهزینه‌تری پیاده‌سازی شده بودند.

بهبود زمان اجرای متد
\lr{\texttt{intervene}}
به ساختن تنها یک کپی و سپس اعمال مقداردهی‌های ثابت
روی این کپی
(به‌جای روش یک کپی به‌ازای هر متغیر)
محدود می‌شود.
برای بهبود متد
\lr{\texttt{evaluate}}
از ویژگی بدون دور بودن مدل علّی بازگشتی استفاده می‌کنیم
(هالپرن و پرل در
\cite{halpern2001causes}
به این ویژگی اشاره کرده‌اند)؛
با توجه به این ویژگی، می‌توانیم ترتیبی روی متغیرها
تعریف کنیم، و سپس مقدار متغیرهای مدل را
با توجه به این ترتیب محاسبه کنیم.
برای تعریف این ترتیب از روش
\lr{Topological Sort}
که برای گراف‌های جهتدار بدون دور تعریف شده است، استفاده می‌کنیم.
استفاده از این روش در مدل‌های بزرگ
(با چندهزار متغیر)
زمان اجرای متد
\lr{\texttt{evaluate}}
را به صورت قابل توجهی افزایش می‌دهد.

\subsection{بهبود روش حل مساله علیت}

در ترخیض اولیه این ابزار، مساله علیت با تعریف اولیه آن
و بدون بهینه‌سازی‌های ارائه شده پیاده‌سازی شده بود.
در نسخه فعلی، بهبودهای ارائه شده در این گزارش
در این ابزار پیاده‌سازی شده
و درستی عملکرد آن‌ها نیز به کمک آزمون‌های واحد و بنچمارک
\LTRfootnote{Benchmark}
موجود آزموده شده است.
در این ابزار از یک سناریوی شبکه نرم‌افزار محور
\LTRfootnote{Software-defined network}
به عنوان بنچمارک استفاده شده است
که در ادامه توضیح داده می‌شود:

\input{figures/blacklist-network.tex}

فرض کنیم شبکه‌ای با ۴ میزبان
$a$، $b$، $c$ و $d$
داریم و می‌خواهیم بسته‌ای از
$a$
را به صورت تصادفی در این شبکه
هدایت کنیم.
؛ این شبکه در شکل
\ref{fig:blacklist-network}
رسم شده است. در این شبکه،
$d$
در \textit{لیست سیاه}
\LTRfootnote{Blacklist}
$a$
قرار دارد، و هیچ‌گاه نباید مسیری از
$a$ به $d$
در این شبکه ساخته شود.
دو پردازه
$P$ و $Q$
دسترسی کنترل به این شبکه دارند و
می‌خواهند با ارسال دو پیام
$p$ و $q$،
به ترتیب یال‌های
$a \to b$ و $c \to b$
را با یال‌های
$a \to c$ و $c \to d$
جایگزین کنند.
واضح است که پس از ارسال این دو پیام
و نصب قوانین متناظر آن‌ها در شبکه،
مسیری از 
$a$ به $d$
تشکیل و ویژگی لیست سیاه در این شبکه نقض می‌شود.

برای این شبکه می‌توانیم ساختمان رویداد زیر را تعریف کنیم:

\begin{align*}
  E & = \set{p_1,q_1,ad_1,p_2,q_2,ad_2} \\ 
  \# & : p_1 \# q_2 \\
  \vdash & :
    \varnothing \vdash p_1,\,
    \varnothing \vdash q_2,\,
    \set{p_1} \vdash q_1,\,
    \set{q_2} \vdash p_2,\,
    \set{p_1,q_1} \vdash ad_1,\,
    \set{p_2,q_2} \vdash ad_2
\end{align*}

رویدادهای
$p_1$، $p_2$ و 
$q_1$، $q_2$
مربوط به دو ترتیب ممکن ارسال پیام‌های
$p$ و $q$
هستند. رویدادهای
$ad_1$ و $ad_2$
نیز برای نمایش وجود مسیر از
$a$ به $d$
در هر یک از ترتیب‌های ارسال تعریف شده‌اند.
شبکه پیکربندی‌های این ساختمان رویداد در شکل
\ref{fig:blacklist-configs}
آمده است. رفتار ناامن در این شبکه را به صورت زیر تعریف می‌کنیم:

\[ \varphi = \exists S
  \in \set{
    \set{p_1,q_1,ad_1},
    \set{q_2,p_2,ad_2}
  }.\;
  S \in \Conf(\ES)
\]

با توجه به این شبکه، به طور شهودی می‌توان
$p_1 \cancel{\#} q_1 (C_{p_1,q_1}=\bot)$
را به عنوان علتی برای رفتار ناامن در نظر گرفت.
صیحانی و دیگران در
\cite{seyhani2022}
نشان می‌دهند که با انتخاب
\[ W=C_{p_2,q_2},\,w=\top,\,\bar{x}=\top \]
مساله علیت برای رفتار ناامن مورد نظر را حل کنیم.

\input{figures/blacklist-configs.tex}

در پیاده‌سازی عملی این شبکه، از ۱۲ رویداد استفاده شده است
(رویدادهایی که در این گزارش نیامده‌اند
برای مدل کردن یال‌های
$a \to b$ و $a \to c$
استفاده می‌شوند.)

در جدول
\ref{tab:blacklist-stats}
مقایسه‌ای بین
حالت اولیه و حالت بهبود یافته
برای این بنچمارک آمده است.
مقدارهای زمانی با واحد ثانیه نوشته شده‌اند.
برای مقدارهای زمانی، تایم‌اوت
\LTRfootnote{Timeout}
۶۰ ثانیه در نظر گرفته شده است.

\begin{table}
  \centering
  \begin{tabular}{ c|c|c|c|c }
    مرحله بهبود &
    $T_{\texttt{init}}+T_{\texttt{is\_cause}}$ &
    تعداد متغیرها &
    تعداد
    $Z$ها &
    $T_{\texttt{evaluate}}$ \\ \hline
    حالت اولیه (بدون بهبود) &
    $>60$ & 49218 & $2^{49216}$ & $>60$ \\ \hline
    بهینه‌سازی متد \lr{\texttt{evaluate}} &
    $>60$ & 49218 & $2^{49216}$ & $\mathbf{0.74}$ \\ \hline
    پیاده‌سازی تصویر $W$ &
    $>60$ & \textbf{546} & $2^{546}$ & $\mathbf{0.004}$ \\ \hline
    کاهش تعداد $Z$ها &
    $\mathbf{7.95}$ & 546 & \textbf{1} & $0.004$
  \end{tabular}
  \caption{جدول مقایسه برای بنچمارک لیست سیاه}
  \label{tab:blacklist-stats}
\end{table}